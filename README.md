# 📈 台股自動化選股與通知系統

本專案為一套針對台灣上市股票（TWSE）設計的自動化選股與通知系統。\
透過不同策略每日篩選目標股票，並以 Email 方式寄送通知結果。

------------------------------------------------------------------------

## 📁 專案結構

    .
    ├── buy_with_dividend.py
    ├── buy_with_dividend_price.py
    ├── buy_follow_corp.py
    ├── buy_with_price_fall.py
    ├── utility_functions.py
    ├── TWSE.xlsx
    ├── Dividend_list.xlsx
    ├── holiday.xlsx
    ├── 2.2TWSE.xlsx
    └── .env

------------------------------------------------------------------------

# 🧠 策略說明

## 1️⃣ 高殖利率篩選

**檔案：`buy_with_dividend.py`**

### 功能

-   讀取 `TWSE.xlsx` 取得股票代號
-   使用 `yfinance` 抓取殖利率
-   篩選條件：

```{=html}
<!-- -->
```
    dividendYield >= 5%

-   產出 `Dividend_list.xlsx`

------------------------------------------------------------------------

## 2️⃣ 高配息 + 股價腰斬策略

**檔案：`buy_with_dividend_price.py`**

### 功能流程

1.  讀取 `Dividend_list.xlsx`
2.  抓取近一年股價資料
3.  篩選條件：

```{=html}
<!-- -->
```
    目前價格 < 一年內最高價 × 0.5

4.  寄送 HTML 表格通知

------------------------------------------------------------------------

## 3️⃣ 法人連續三日買超

**檔案：`buy_follow_corp.py`**

### 功能流程

1.  往前回推最近 10 天
2.  排除假日與休市
3.  取得最近三個交易日資料
4.  篩選條件：

```{=html}
<!-- -->
```
    三大法人買賣超股數 > 0

5.  取前 50 名
6.  找出連續三日買超股票
7.  寄送通知

------------------------------------------------------------------------

## 4️⃣ 連續兩日暴跌策略

**檔案：`buy_with_price_fall.py`**

### 篩選條件

計算最近三日收盤價：

    今日跌幅 <= -5%
    昨日跌幅 <= -5%

### 輸出

-   股票代號
-   今日價格
-   今日跌幅
-   相關新聞（Yahoo 財經）

輸出檔案：

    fall_stock_news.xlsx

並寄送 HTML 郵件通知。

------------------------------------------------------------------------

# 🔧 共用工具模組

**檔案：`utility_functions.py`**

## 功能列表

### 判斷是否開盤

``` python
is_open(date: datetime.date)
```

-   判斷週末
-   讀取 `holiday.xlsx`
-   回傳：
    -   "Open"
    -   "Close"

------------------------------------------------------------------------

### 三大法人資料抓取

``` python
twse_data(r_date: str, type: str)
```

-   來源：TWSE 官方 API
-   回傳 DataFrame

------------------------------------------------------------------------

### 寄信功能

``` python
sendmail(arr_list, title, body, mode, file_path, file_name)
```

支援： - 純文字 - HTML - 附件

使用 Gmail SMTP\
帳號密碼透過 AES 加密解密

------------------------------------------------------------------------

### Yahoo 新聞抓取

``` python
get_yahoo_news(stock: str)
```

-   抓取：
    -   新聞連結
    -   標題
    -   日期

------------------------------------------------------------------------

# ⚙️ 環境需求

## Python 套件

    pandas
    numpy
    yfinance
    requests
    beautifulsoup4
    python-dotenv
    openpyxl

安裝方式：

``` bash
pip install -r requirements.txt
```

------------------------------------------------------------------------

# 🔐 環境變數設定

建立 `.env` 檔：

    RECEIVER1=xxx@gmail.com
    RECEIVER2=xxx@gmail.com

------------------------------------------------------------------------

# 📄 必備 Excel 檔案

  檔名                 用途
  -------------------- ------------------
  TWSE.xlsx            全部股票代號
  Dividend_list.xlsx   高殖利率清單
  holiday.xlsx         台股休市表
  2.2TWSE.xlsx         股票代號對照名稱

------------------------------------------------------------------------

# 🚀 建議執行順序

每日排程（建議使用 Windows 工作排程器 或 crontab）

    1. buy_with_dividend.py
    2. buy_with_dividend_price.py
    3. buy_follow_corp.py
    4. buy_with_price_fall.py

------------------------------------------------------------------------

# ⚠️ 風險聲明

本系統僅供資料篩選與參考用途。\
投資有風險，請自行審慎評估。
